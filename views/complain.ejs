<!DOCTYPE html>
<html>
  <head>
    <title>RSQIS</title>
    <%- include('./common/link'); %> <%- include('./common/navbar',{nav:{
    home:"", road:"", work:"", user:data.user, username:data.username }}); %>
    <style>
      body {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container" style="margin-top: 5%; margin-bottom: 5%;">
      <!-- Card -->
      <h3
        class="text-center"
        style="margin-top: 10%; text-decoration: underline;"
      >
        Complaints
      </h3>
      <br />
      <div class="row">
        <br />
        <%if(data.data!=null){%>
          <%for(let x=0;x<data.data.length;x++){%>
        <div class="col col-md-4">
          <div class="card">
            <!-- Card image -->
            <img
              class="card-img-top"
              src="/images/<%=data.data[x].path%>"
              alt="Card image cap"
            />

            <!-- Card content -->
            <div class="card-body">
              <!-- Title -->
              <h4 class="card-title"><a><%=data.data[x].Email%></a></h4>
              <!-- Text -->
              <p class="card-text">
                <%=data.data[x].issue%>
              </p>
              <p><b>Address:</b><i><%=data.data[x].address%> </i></p>
              <p><b>Latitude:</b><i><%=data.data[x].lat%></i></p>
              <p><b>Longitude:</b><i><%=data.data[x].lng%></i></p>
              <Button class="btn btn-danger" onclick="del('<%=data.data[x].feedID%>%>')" >Delete</Button>
            </div>
          </div>

          <!-- Card -->
        </div>
        <%}%>
        <%} else {%>
        <h4 class="text-center" style="margin: auto;">No data found</h4>
        <%}%>
      </div>
    </div>
    <script
  src="https://code.jquery.com/jquery-3.5.0.min.js"
  integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ="
  crossorigin="anonymous"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script>
      function del(id){
        swal({
  title: "Are you sure?",
  text: "Once deleted, you will not be able to recover data!",
  icon: "warning",
  buttons: true,
  dangerMode: true,
})
.then((willDelete) => {
  if (willDelete) {

    $.ajax({
    url: 'http://localhost:3000/delete/comp/'+id,
    type: 'DELETE',
    success: function(result) {
      
      swal("Successfully deleted complaint", {
      icon: "success",
    }).then(()=>{
      location.reload();
    }) 
      
    }});

    
    
  } else {
    swal("Your data is not deleted!");
  }
});
      }
      </script>
  </body>
</html>
